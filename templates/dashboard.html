<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Pulsa 7L</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Exo:wght@100..900&family=Titillium+Web:wght@200..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles_dash.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-logo">
            <h2>Pulsa 7L</h2>
        </div>
        <ul class="sidebar-menu">
            <li><a href="{{ url_for('dashboard') }}" class="active">Dashboard</a></li>
            <li><a href="{{ url_for('settings') }}">Settings</a></li>
            <li><a href="{{ url_for('logout') }}">Logout</a></li>
        </ul>
    </div>
    <div class="main-content">
        <div class="introbar">
            <h1>Bem-vindo, {{nome}}!</h1>
            <p>Aqui está o resultado da sua Pulsa 7L. A nota está baseada em {{qtd_respostas}} respostas, entre os dias {{data_min}} e {{data_max}}</p>
        </div>
        <div class="container">
            <div class="container-cards geral">
                <div class="card" id="card-geral">
                    <div class="bar-container">
                        <h2>Nota Geral:</h2>
                        <div class="bar">
                            <div class="bar-size">
                                <div class="bar-value" style="width: {{size_bar}}%;">{{nota_media}}</div>
                            </div>
                            <div class="bar-total">10</div>
                        </div>
                        
                        <h2>Frequência Geral:</h2>
                        <div class="bar">
                            <div class="bar-size">
                                <div class="bar-value" style="width: {{size_bar}}%;">{{nota_media}}</div>
                            </div>
                            <div class="bar-total">100</div>
                        </div>
                    </div>
                </div>
                <div class="card" id="card-grafico">
                    <canvas id="lineChart"></canvas>
                </div>
            </div>
            <div class="container-cards detalhado">
                {% for card in cards %}
                <div class="card-detalhe" id="card-{{ card.id }}">
                    <h3>{{ card.title }}</h3>
                    <div class="bar">
                        <div class="bar-size">
                            <div class="bar-value" style="width: {{ card.size }}%;">{{ card.value }}</div>
                        </div>
                        <div class="bar-total">{{ card.total }}</div>
                    </div>
                    <div class="info-respostas">
                        <p>Nota baseada em {{card.qtd_respostas}} respostas, entre os dias {{data_min}} e {{data_max}}</p>
                    </div>
                    <div class="details">
                        <button class="details-button">
                        <i class="fas fa-plus"></i> Detalhes
                    </button></i></div>
                </div>
                {% endfor %}
            </div>
            </div>
        </div>
    </div>
    <script>
        // Data for the line chart
        const labels = ['Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta'];
        const data = {
            labels: labels,
            datasets: [
                {
                    label: 'Nota',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    data: [5, 6, 7, 8, 6],
                },
                {
                    label: 'Frequência',
                    backgroundColor: 'rgba(153, 102, 255, 0.2)',
                    borderColor: 'rgba(153, 102, 255, 1)',
                    data: [2, 3, 4, 5, 4],
                }
            ]
        };

        // Config for the line chart
        const config = {
            type: 'line',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        };

        // Render the chart
        const lineChart = new Chart(
            document.getElementById('lineChart'),
            config
        );
    </script>
</body>
</html>
